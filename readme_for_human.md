# 광전타임즈 (KJ Times) 안내서

이 문서는 광전타임즈 프로젝트를 처음 접하는 사람을 위해 작성했습니다. 중학생도 이해할 수 있도록 쉬운 비유를 들어 설명합니다.

### a) 프로젝트 소개

광전타임즈는 우리 지역의 소식을 전하는 인터넷 뉴스 플랫폼입니다. 크게 두 가지 부분으로 나뉩니다. 첫째는 독자들이 뉴스를 읽는 사이트입니다. 둘째는 기자가 글을 쓰고 관리하는 사무실 공간입니다.

웹사이트 주소: https://kj-news.vercel.app

### b) 어떤 기술을 사용했나요?

웹사이트를 만들기 위해 여러 가지 도구를 사용했습니다.

*   **Next.js 16 (App Router):** 웹사이트를 만드는 똑똑한 공장입니다. 복잡한 일을 알아서 처리해 주는 아주 든든한 프레임워크입니다. React라는 기술을 바탕으로 만들어졌습니다.
*   **React 19:** 화면을 구성하는 레고 블록입니다. 작은 부품들을 조립해서 하나의 완성된 페이지를 만듭니다.
*   **TypeScript:** 코딩할 때 실수를 미리 찾아주는 돋보기입니다. 글자의 종류를 미리 정해두어 오류를 방지합니다.
*   **Supabase:** 뉴스 기사를 저장하는 창고이자 사진을 보관하는 보관소입니다. 서버라는 복잡한 장비를 직접 관리하지 않아도 인터넷 기능을 쓸 수 있게 해주는 서비스입니다.
*   **TipTap v3:** 기사를 쓰는 연습장입니다. 우리가 흔히 쓰는 워드프로세서처럼 글자를 굵게 만들거나 제목을 정하는 기능을 제공합니다.
*   **Tailwind CSS v4:** 웹사이트의 색을 칠하고 옷을 입히는 디자인 도구입니다. 미리 정해진 이름을 사용해서 아주 빠르게 꾸밀 수 있습니다.
*   **Vercel:** 만든 사이트를 전 세계 사람들이 볼 수 있게 인터넷에 올려주는 서비스입니다. GitHub에 코드를 올리면 자동으로 사이트가 업데이트됩니다.
*   **Vitest:** 우리가 만든 기능이 제대로 돌아가는지 시험해보는 자동 시험지입니다.

### c) 프로젝트 구조

파일들이 어떻게 모여 있는지 간단히 살펴보겠습니다.

*   `src/app/(public)/`: 일반 독자들이 들어와서 뉴스를 읽는 페이지들이 모여 있습니다.
*   `src/app/admin/`: 기자나 관리자만 들어갈 수 있는 비밀 사무실입니다.
*   `src/app/api/`: 데이터가 오가는 통로 역할을 하는 기능들이 담겨 있습니다.
*   `src/app/special/`: 특별한 날에만 보여주는 멋진 레이아웃의 뉴스 페이지입니다.
*   `src/components/`: 버튼이나 메뉴처럼 여러 번 다시 사용하는 화면 조각들입니다.
*   `src/contexts/`: 로그인 정보처럼 앱 전체가 공유해야 하는 소중한 정보를 담는 주머니입니다.
*   `src/lib/`: 공통으로 쓰는 유용한 도구와 데이터베이스 연결 함수가 들어 있습니다.
*   `scripts/`: 처음 데이터 창고를 세팅할 때 사용하는 명령서들입니다.
*   `supabase/migrations/`: 데이터 창고가 지금까지 어떻게 변했는지 기록한 역사책입니다.
*   `public/`: 로고나 배경 이미지 같은 정적 파일들을 넣어두는 곳입니다.

### d) 핵심 기능 설명

이 서비스는 이런 일들을 할 수 있습니다.

1.  **홈페이지:** 최신 기사와 가장 인기 있는 기사를 보여줍니다. 주제별 뉴스나 긴급하게 전하는 소식 티커도 한눈에 볼 수 있습니다.
2.  **기사 상세 페이지:** 기사 전문을 읽는 곳입니다. 읽고 있는 글과 비슷한 뉴스도 추천해주고, 조회수 카운터, 친구에게 공유하거나 종이로 인쇄하는 기능도 있습니다.
3.  **카테고리 페이지:** 정치, 경제, 사회, 문화, 국제, IT/과학, 스포츠 등 관심 있는 주제만 모아서 볼 수 있습니다.
4.  **검색:** 제목, 요약글, 태그를 검색해서 원하는 뉴스를 빠르게 찾습니다.
5.  **독자 문의:** 신문사에 궁금한 점을 연락처 양식을 통해 보낼 수 있습니다.
6.  **특별판:** 사이트의 전체 기사를 특별한 디자인으로 모아보는 페이지입니다.
7.  **관리자 대시보드:** 기사가 총 몇 개인지, 사람들이 얼마나 읽었는지 통계 그래프를 보여줍니다.
8.  **기사 관리:** 기사를 새로 쓰고, 수정하고, 지울 수 있습니다. 임시 저장(draft), 검토 대기(pending_review), 예약(scheduled), 발행(published), 보관(archived), 거절(rejected) 등 여러 상태로 관리합니다.
9.  **뉴스팩토리 (NF):** 외부 API에서 배포하는 보도자료 목록을 가져와서 클릭 한 번으로 기사 양식에 맞게 변환합니다.
10. **사이트 설정:** 뉴스팩토리 API 연결을 위한 주소와 열쇠 등을 관리합니다.
11. **검색 엔진 최적화 (SEO):** 구글이나 네이버에서 뉴스가 잘 검색되도록 RSS 피드, 사이트맵, 로봇 설정 파일(robots.txt) 등을 자동으로 만듭니다.
12. **보안:** 해커들로부터 사이트를 안전하게 지키기 위해 CSP, HSTS 같은 튼튼한 방어벽을 세워두었습니다.

### e) 데이터가 흐르는 과정

뉴스가 어떻게 전달되는지 이야기로 들어보세요.

독자가 홈페이지에 들어오면, 서버는 데이터 창고에서 이미 발행된(published) 기사들을 꺼내옵니다. 꺼내온 기사들을 예쁜 화면에 담아서 독자의 브라우저로 보내줍니다.

기자가 기사를 쓸 때는 연습장에 글을 적고 저장 버튼을 누릅니다. 그러면 데이터 창고에 안전하게 보관됩니다. 발행 버튼을 눌러 상태를 변경하면 그때부터 독자들이 읽을 수 있는 상태가 됩니다.

뉴스팩토리 기능은 조금 더 특별합니다. 관리자가 탭을 열면 외부의 보도자료 목록이 보입니다. 마음에 드는 글을 고르고 가져오기 버튼을 누르면, 제목과 내용이 기사 작성 양식에 자동으로 채워집니다. 아주 편리하게 뉴스를 만들 수 있습니다.

### f) 데이터베이스 테이블

데이터 창고에는 여러 개의 장부가 있습니다.

*   **articles:** 기사 제목, 내용, 카테고리, 쓴 날짜, 상태 등이 기록된 메인 장부입니다.
*   **categories:** 정치나 경제 같은 주제들의 이름표가 들어 있습니다.
*   **authors:** 기사를 쓴 기자님들의 정보입니다.
*   **contact_messages:** 독자들이 보낸 문의 사항이 담긴 편지함입니다.
*   **nf_imports:** 뉴스팩토리에서 어떤 기사를 가져왔는지 기록한 일지입니다.
*   **site_settings:** 사이트 작동에 꼭 필요한 API 주소나 비밀키 설정값들이 들어 있습니다.

### g) 인증

관리자 페이지는 아무나 들어올 수 없도록 보호되어 있습니다. Supabase Auth라는 서비스를 통해 로그인 기능을 구현했습니다. 관리자가 로그인을 하면 입장권(세션)이 발행됩니다. 앱 전체를 감싸고 있는 주머니(AuthContext)가 이 입장권을 확인합니다. 입장권이 있는 사람만 기사를 관리하는 비밀 사무실(관리자 페이지)에 접근할 수 있게 통제합니다.

### h) 환경 변수 설정 (.env)

사이트를 실행하기 위해 필요한 비밀 정보들입니다. `.env.local` 파일에 작성합니다.

```
NEXT_PUBLIC_SUPABASE_URL=      # Supabase 프로젝트 주소
NEXT_PUBLIC_SUPABASE_ANON_KEY= # Supabase 공개 키
SUPABASE_SERVICE_ROLE_KEY=     # Supabase 서비스 역할 키 (비밀)
NEXT_PUBLIC_SITE_URL=          # 사이트 주소 (예: https://kj-news.vercel.app)
ZOHO_SMTP_HOST=smtp.zoho.com   # 이메일 발송 서버 주소
ZOHO_SMTP_PORT=465
ZOHO_SMTP_USER=                # 이메일 계정 아이디
ZOHO_SMTP_PASS=                # 이메일 계정 비밀번호
DATABASE_URL=                  # 데이터베이스 직접 연결 주소
ADMIN_PASSWORD=                # 관리자 초기 비밀번호
```

### i) 로컬 개발 시작하기

내 컴퓨터에서 이 프로젝트를 실행하는 방법입니다.

```bash
git clone [저장소 주소]
cp .env.example .env.local  # 환경변수 설정 파일 복사
npm install                 # 필요한 도구들 설치
npm run dev                 # 개발 서버 실행
```

### j) 배포

이 프로젝트는 Vercel이라는 곳에 연결되어 있습니다. 코드를 수정해서 메인(main) 브랜치에 올리기만 하면, 인터넷에 있는 사이트가 자동으로 업데이트됩니다.

### k) 테스트

코드가 잘 작동하는지 확인하려면 다음 명령어를 사용하세요.

```bash
npm test            # 전체 테스트 실행
npm run test:watch  # 코드가 변할 때마다 자동으로 테스트
```
